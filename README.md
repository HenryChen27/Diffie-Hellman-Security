# Diffie-Hellman 协议实现与改进：中间人攻击研究与防御

## 项目简介

本项目实现了经典的 Diffie-Hellman 密钥交换协议，并研究了其中间人攻击漏洞。通过 TCP Socket 建立客户端与服务器之间的通信，使用 Diffie-Hellman 协议协商共享密钥，并采用 AES256-GCM 加密算法对通信数据进行加密。此外，项目还实现了中间人攻击程序，展示了协议的潜在安全漏洞，并提出了基于数字签名的防御方案。

## 主要功能

1. **Diffie-Hellman 协议实现**：
   - 客户端与服务器通过 TCP Socket 建立安全通信
   - 实现大数运算（512位）支持密钥交换
   - 使用 AES256-GCM 进行数据加密传输

2. **中间人攻击研究**：
   - ARP 欺骗实现网络流量劫持
   - 实时拦截并篡改加密通信内容
   - 展示协议在无身份验证情况下的安全漏洞

3. **防御机制**：
   - 实现基于 RSA 的数字签名方案
   - 防止中间人篡改通信内容
   - 提供身份验证功能

## 运行环境

- **操作系统**：Linux（推荐 Ubuntu）
- **编译器**：支持 C++11 的编译器（如 g++）
- **依赖库**：
  - libpcap（用于网络抓包）
  - 标准 C/C++ 库

## 编译与运行
分别使用3个不同虚拟机分别代表服务端、客户端与攻击者
记录下各自的ip并修改对应程序代码中的ip后进行编译

### 服务器端
```bash
g++ server.cpp -o server -lpcap
./server
```

### 客户端
```bash
g++ client.cpp -o client -lpcap
./client
```

### ARP欺骗程序
```bash
g++ arp.cpp -o mitm -lpcap
./arp
```

### 中间人攻击程序
```bash
g++ attacker.cpp -o mitm -lpcap
./attacker
```

## 项目结构

```
Diffie-Hellman-Security/
├── client.cpp                        # 客户端实现
├── client_plus.cpp                # 改进后客户端实现
├── server.cpp                      # 服务器实现
├── server_plus.cpp              # 改进后服务器实现
├── attacker.cpp                  # 中间人攻击程序
├── arp.cpp                         # ARP欺骗程序
└──README.md                  # 项目说明文件
```

## 使用说明
### 正常加密通信流程
1. 首先启动服务器程序
2. 然后启动客户端程序与服务器建立连接进行正常加密通信流程

### 中间人攻击过程
1. 首先启动服务器程序
2. 然后启动ARP欺骗程序以及中间人攻击程序
3. 启动客户端程序与服务器建立连接，通信过程中发现内容被攻击者被篡改但是客户端与服务端并没有察觉

### 防御过程
1. 与中间人攻击过程相同，但需要运行改进后的服务端与客户端程序
2. 客户端与服务器端发现内容被篡改


## 测试结果
项目包含完整的测试案例，展示了：
- 正常加密通信流程
- 中间人攻击过程
- 防御机制的有效性

